# Excel查询系统参数说明

## 下载区
 <a name="下载区">下载区</a>

### 下载区参数详解

1. 数据表名（必填）

   一般为表单的名称，

   查询时可以使用等于、IN、包含等条件

2. 学号/工号

   在指定pid列时，可以查询

3. 姓名

   在指定姓名列时，可以查询

4. 显示字段/不显示字段
    查询时显示部分字段或不显示部分字段，数据库的部分包含密码的敏感数据已被清除。

5. 排序字段
    以哪些字段作为排序的字段，多个字段，中间以英文逗号分隔。

6. 是否升序
    默认都是升序，也可以设为否，这样就是降序了

### 典型的下载查询条件

| 数据表名 | 等于   | 经费使用测试                                             |
| -------- | ------ | -------------------------------------------------------- |
| d5       | 大于等 | 20190101                                                 |
| d5       | 小于等 | 20190514                                                 |
| d1       | 包含   | 费用                                                     |
| d1       | IN     | [12年]5003科研项目费用,[13年]5101设备费,[13年]5109劳务费 |
| 显示字段 | 等于   | d1,d2,d3,d4,d5,d6                                        |
| 排序字段 | 等于   | d4                                                       |
| 是否升序 | 等于   | 否                                                       |

## 密码区
 <a name="密码区">密码区</a>
### 密码参数详解
1. 查看密码
    * 有查看密码就可以查看所有的数据。
    建议密码设置的长一些，不用记忆，保存在Excel中即可。建议在这个单元格内填写 “随机”两个字，这样，程序会自动生一个很复杂的10位密码。
2. 上传密码
    * 有上传密码就可以修改数据。
    建议密码设置的长一些，不用记忆，保存在Excel中即可。建议在这个单元格内填写 “随机”两个字，这样，程序会自动生一个很复杂的14位密码。
3. 用户名/用户密码
    * 这是用户在网站中的帐号与密码，在强安全的模式下，必须登陆网站后才能进行下一步的操作。在Excel中提供用户名及密码后，程序会上传至服务器进行校验，成功才能进行下一步。

    * 在程序自动登陆网站的前题下，用户用查看密码进行下载数据或上传密码及其它气操作。
4. 查询网址
就是服务器的网址，如果本地服务器就是 http://127.0.0.1



## 上传区
 <a name="上传区">上传区</a>
### 上传参数详解

1. 查询参数：姓名字段（重要）
    * 查询时如果指定了姓名字段，在线查询时会优先查询对应的数据，暂时无法模糊查询。
    * 在线查询时，会自动完成提示。
    
2. 查询参数：ID字段
   
    * 查询时如果指定了id字段，在线查询时会优先查询对应的数据。
    
3. 查询参数：分类字段
    在线查询时使用的，把数据分成几类，方便查找。效果如下

    ![](http://vps0.upsir.com/img/Typora_HnGoYOV8yg.png)

4. 查询参数：缩略显示

   查询界面要显示的字段，通常数据比较多，我们可以定制性的显示3列左右。这样方便手机查看。

5. 查询参数：可写权限、可读权限

   这里可以填写用记的id所在的列，这样用户就可以有权查看或修改自己的信息了。

5. 表单参数：提示字段
   用户输入时，可以自动提示之前输入的数据，方便用户填写。
   可以提前按列输入数据

6. 表单参数：匿名填表
   万能表单的功能，能不能匿名填表。重要的表单可以不充许匿名填写。

6. 表单参数：初始数据行
   默认的提示字段会按用户填写情况，自动提示，如果用户填错会误导后面的用户，所以可以先填入。

6. 上传参数：覆盖上传
   默认是，覆盖上传时，程序会把服务器上的数据全清空，再把现有的数据上传。
   非本覆盖上传时，服务器的数据不清空，直接在后面添加。

姓名字段,提示字段,ID字段,匿名填表,缩略显示,分类字段,覆盖上传,表格说明,初始数据行数

### 典型的上传条件

| 姓名字段 | d1          |
| -------- | ----------- |
| ID字段   | d7          |
| 匿名填表 | 是          |
| 分类字段 | d1          |
| 缩略显示 | d5,d2,d4    |
| 提示字段 | d1,d2,d4,d5 |
| 覆盖上传 | 是          |

## 本地参数区
 <a name="本地参数区">本地参数区</a>
### 本地参数详解
1. 查询网址
    每次点下载数据时，会自动生成网址，点击这个网址就会看到带查询参数的网址，结合不同的格式，可以得到自己想要的实时结果。现在可以实时展示万能表单的结果。
2. 复制到/数据表
    我们的表格是带宏的数据表，但如果你想获得不带宏的表格，你可以在这里设置要目标表及位置，程序会自动生成一个干净的excel表，方便上交。
3. 弹窗提示更新
    这里不建议修改。
4. 文件管理参数：自动下载文件
    * 部分记录中记录了一个附件对应的网址，我们是否想把它下载到本地。
    * 如果数据较多，建议先填否，最后一起下载。
    * 参数否，不下载附件；参数是，按文件名及文件夹的命名规则下载； 参数“按网站结构下载”，这个是为了方便数据迁移用的。把文件把包上传到新服务器，再将数据上传即可。
5. 文件管理参数：文件名命名规则
    * 可以对下载的数据进行文件名的命名，可以有多个字段，中间用逗号分隔开，这里要用列序号，
    
6. 文件管理参数：自动建文件夹
    * 可以对下载的数据进行文件名的命名，可以有多个字段，中间用逗号分隔开，这里要用列序号.
7. 文件管理参数：附件根目录
    * 就是附件的根目录，可以填空，默认是工作表名。

6. 下载网址
    这是查询数据时对应的URL，用这个URL可以脱离Excel，实现在线输出查询结果。
    现在可以实时展示万能表单的结果。
### 典型的本地参数

| 复制到         | A21    |
| -------------- | ------ |
| 数据表         | sheet1 |
| 弹窗提示更新   | 否     |
| 文件名命名规则 | B,A,F  |
| 自动下载文件   | 否     |
| 下载网址       |        |

## 特殊关键词
 <a name="特殊关键词">特殊关键词</a>
### 标题中的特殊关键词
1. 文件
    标题中如果左侧两个字有“文件”两个字，程序会认为这是文件，可以上传文件，网站中也会把这一列设为文件，会显示上传文件的控件。
    
    1. 标题中不仅有文件两个字，还有**自定义**几个字
        程序会认为这是文件，上传文件，不会重命名文件，只会按文件名直接上传文件，这样可以附加一些信息。
    
2. 照片

    标题中如果左侧有“照片”两个字，程序会认为这是照片，会提示拍摄照片或上传文件。

3. 今日

    标题中如果左侧有“照片”两个字，程序会认为这是照片，会提示拍摄照片或上传文件。

### 权限

1. 管理员无视用户的查看密码
   管理员仅限用户 admin ，在仅知道用户的数据表名的情况下，可以下载数据表的数据。
   比较适合多表汇总这种情况
2. 匿名情况下的线权限
   用户可以通过上传后的网址直接查询数据，也可以通用网址修改数据。所以请对这个网址保密。
3. 强安全情况下权限
   * 用户在登陆网站后，才可以查询及修改数据；
   * 每个用户在网站中都有自己的查看密码、上传密码；
   * 只能由管理员进行修改用户有密码，以增强安全性。
4. 读/写权限字段：
   * 读写权限字段对应相应的用户名的情况下，可读及可写。











